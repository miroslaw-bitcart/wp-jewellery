window.archetype=function(e){var t=_Archetype.ajaxurl;var n=function(){};n.prototype={constructor:n,post:function(n,r,i){r.action=n;return e.ajax({type:"post",dataType:"json",url:t,data:r}).done(i)},isUserLoggedIn:function(){return _Archetype.isUserLoggedIn}};return n}(jQuery);var Archetype=new archetype;window.at_facebook=function(e,t){function s(r){var i=n;t(document).trigger("ArchetypeFB_AJAXstart",i);Archetype.post("fb_login",{response:r},function(n){console.log("cc");e.api("/me",function(e){console.log(e);t(document).trigger("ArchetypeFB_AJAXstop",i);t(document).trigger("ArchetypeFB_Login",[n,e])})})}function o(r){var i=n;t(document).trigger("ArchetypeFB_AJAXstart",i);Archetype.post("fb_connect",{response:r},function(n){e.api("/me",function(e){t(document).trigger("ArchetypeFB_AJAXstop",i);t(document).trigger("ArchetypeFB_Connect",[n,e])})})}function u(r){var i=n;t(document).trigger("ArchetypeFB_AJAXstart",i);e.api("/me",function(e){t(document).trigger("ArchetypeFB_AJAXstop",i);t(document).trigger("ArchetypeFB_Signup",[r,e])})}var n=undefined;var r=false;var i=this;e.Event.subscribe("auth.authResponseChange",function(e){if(e.status==="connected"&&!Archetype.isUserLoggedIn()){if(r){u(e)}else{s(e)}}else if(e.status==="connected"){o(e)}});this.contactFacebook=function(r){n=r.target;var i=t(this).data("scope");e.login(function(){},{scope:i})};t(document).ready(function(){t(".at_fb_login").on("click",function(e){i.contactFacebook(e)});t(".at_fb_connect").on("click",function(e){i.contactFacebook(e)});t(".at_fb_signup").on("click",function(e){r=true;i.contactFacebook(e)})})};jQuery(document).ready(function(e){e(".tn_message").on("click",function(){e(this).fadeOut()})});(function(){var e,t,n=function(e,n){if("function"===typeof document.addEventListener||i.isIE8()){var o=!1;try{o=e instanceof Element}catch(u){o=!!e&&1===o.nodeType}o||"string"===typeof e||(n=e);var a=this,f=a.classes,l=a.settings=i.merge(a.defaults,{attachTo:e},n||{}),o=a.container=i.make("div",{"class":f.container}),c=a.calendars=[],p=t().day(l.weekStart),m,g=[],y,b,w;y=[];var E;b=0;m=l.months;i.isIE8()&&i.addClassName(o,"ie8");for(b=7;b--;)g.push(p.format(l.columnHeaderFormat)),p.add("days",1);s(a);if("object"===typeof l.subscribe)for(b in l.subscribe)l.subscribe.hasOwnProperty(b)&&a.subscribe(b,l.subscribe[b]);a._sel=[];l.selected&&a.setSelected(l.selected,!1);m=l.viewStartDate?t(l.viewStartDate,l.format):0<a._sel.length?t(a._sel[0]):t();a.viewStartDate=m.date(1);if((m={past:l.months-1,"today-past":l.months-1,any:2<l.months?Math.floor(l.months/2):0,"today-future":0,future:0}[this.settings.direction])&&t().month()==t(a.viewStartDate).month())a.viewStartDate=t(a.viewStartDate).subtract({M:m}).date(1);if("function"===typeof l.blackout)a.blackout=l.blackout;else if(l.blackout){var S=r(l.blackout,l.parseSplitDelimiter);a.blackout=function(e){e=t(e).yearDay();if(1>e||!a._sel)return!1;for(var n=S.length;n--;)if(S[n].yearDay()===e)return!0;return!1}}else a.blackout=function(){return!1};a.direction=a.directions[l.direction]?a.directions[l.direction]:a.directions.any;for(m=Math.max(l.months,1);m--;){y=i.make("div",{"class":f.calendar},o);y.setAttribute("data-cal-index",m);1<l.months&&(m==Math.max(l.months-1,1)?i.addClassName(y,f.monthFirst):0===m?i.addClassName(y,f.monthLast):i.addClassName(y,f.monthMiddle));b=i.make("div",{"class":f.title},y);l.useYearNav||i.addClassName(b,f.disableYearNav);i.make("a",{"class":f.previousYear},b);i.make("a",{"class":f.previousMonth},b);i.make("a",{"class":f.nextYear},b);i.make("a",{"class":f.nextMonth},b);p=i.make("span",{"class":f.caption},b);w=i.make("div",{"class":f.header},y);b=0;do E=i.make("span",{},w),E.innerHTML=g[b];while(7>++b);w=i.make("div",{"class":f.days},y);b=0;for(y=[];42>b++;)y.push(i.make("span",{},w));c.push({caption:p,days:y});m&&i.make("div",{"class":f.monthSeparator},o)}a.draw();i.addEvent(o,"mousedown",function(e,n){var r;if(i.hasClassName(n,f.nextMonth))!a.disableNext&&!1!==a.publish("view-changed",a,["next-month"])&&(a.viewStartDate.add("months",1),a.draw());else if(i.hasClassName(n,f.previousMonth))!a.disablePreviousMonth&&!1!==a.publish("view-changed",a,["previous-month"])&&(a.viewStartDate.subtract("months",1),a.draw());else if(i.hasClassName(n,f.nextYear))!a.disableNext&&!1!==a.publish("view-changed",a,["next-year"])&&(a.viewStartDate.add("years",1),a.draw());else if(i.hasClassName(n,f.previousYear))!a.disablePreviousMonth&&!1!==a.publish("view-changed",a,["previous-year"])&&(a.viewStartDate.subtract("years",1),a.draw());else if(i.hasClassName(n.parentNode,f.days)&&i.hasClassName(n,f.dayActive)&&(r=n.getAttribute("data-date")))if(r=t(r,l.dayAttributeFormat).hours(12),!1!==a.publish("date-clicked",a,[r]))switch(l.mode){case"multiple":a.addSelected(r)||a.removeSelected(r);break;case"range":a.addSelected(r);break;default:a.addSelected(r)}return!1});(l.attachTo=i.$(l.attachTo))&&l.attachTo.appendChild(o)}};n.prototype={defaults:{attachTo:null,months:1,weekStart:0,direction:"any",directionScrolling:!0,viewStartDate:null,blackout:null,selected:null,mode:"single",dayOutOfMonthClickable:!1,format:null,subscribe:null,columnHeaderFormat:"dd",titleFormat:"MMMM, YYYY",dayNumberFormat:"D",dayAttributeFormat:"YYYY-MM-DD",parseSplitDelimiter:/,\s*|\s+-\s+/,rangeDelimiter:" - ",multipleDelimiter:", ",useYearNav:!0,dateClassMap:{}},classes:{container:"kalendae",calendar:"k-calendar",monthFirst:"k-first-month",monthMiddle:"k-middle-month",monthLast:"k-last-month",title:"k-title",previousMonth:"k-btn-previous-month",nextMonth:"k-btn-next-month",previousYear:"k-btn-previous-year",nextYear:"k-btn-next-year",caption:"k-caption",header:"k-header",days:"k-days",dayOutOfMonth:"k-out-of-month",dayInMonth:"k-in-month",dayActive:"k-active",daySelected:"k-selected",dayInRange:"k-range",dayToday:"k-today",monthSeparator:"k-separator",disablePreviousMonth:"k-disable-previous-month-btn",disableNextMonth:"k-disable-next-month-btn",disablePreviousYear:"k-disable-previous-year-btn",disableNextYear:"k-disable-next-year-btn",disableYearNav:"k-disable-year-nav"},disablePreviousMonth:!1,disableNextMonth:!1,disablePreviousYear:!1,disableNextYear:!1,directions:{past:function(n){return t(n).yearDay()>=e.yearDay()},"today-past":function(n){return t(n).yearDay()>e.yearDay()},any:function(){return!1},"today-future":function(n){return t(n).yearDay()<e.yearDay()},future:function(n){return t(n).yearDay()<=e.yearDay()}},getSelectedAsDates:function(){for(var e=[],t=0,n=this._sel.length;t<n;t++)e.push(this._sel[t].toDate());return e},getSelectedAsText:function(e){for(var t=[],n=0,r=this._sel.length;n<r;n++)t.push(this._sel[n].format(e||this.settings.format||"YYYY-MM-DD"));return t},getSelectedRaw:function(){for(var e=[],n=0,r=this._sel.length;n<r;n++)e.push(t(this._sel[n]));return e},getSelected:function(e){e=this.getSelectedAsText(e);switch(this.settings.mode){case"range":return e.splice(2),e.join(this.settings.rangeDelimiter);case"multiple":return e.join(this.settings.multipleDelimiter);default:return e[0]}},isSelected:function(e){e=t(e).yearDay();if(1>e||!this._sel||1>this._sel.length)return!1;switch(this.settings.mode){case"range":var n=this._sel[0]?this._sel[0].yearDay():0,r=this._sel[1]?this._sel[1].yearDay():0;return n===e||r===e?1:!n||!r?0:e>n&&e<r||n<r&&e<n&&e>r?-1:!1;case"multiple":for(n=this._sel.length;n--;)if(this._sel[n].yearDay()===e)return!0;return!1;default:return this._sel[0]&&this._sel[0].yearDay()===e}},setSelected:function(e,t){var n,i=r(e,this.settings.parseSplitDelimiter,this.settings.format),s=r(this.getSelected(),this.settings.parseSplitDelimiter,this.settings.format);for(n=s.length;n--;)this.removeSelected(s[n],t);for(n=i.length;n--;)this.addSelected(i[n],t);!1!==t&&this.draw()},addSelected:function(e,n){e=t(e).hours(12);this.settings.dayOutOfMonthClickable&&"range"!==this.settings.mode&&this.makeSelectedDateVisible(e);switch(this.settings.mode){case"multiple":if(this.isSelected(e))return!1;this._sel.push(e);break;case"range":1!==this._sel.length?this._sel=[e]:e.yearDay()>this._sel[0].yearDay()?this._sel[1]=e:this._sel=[e,this._sel[0]];break;default:this._sel=[e]}this._sel.sort(function(e,t){return e.yearDay()-t.yearDay()});this.publish("change",this,[e]);!1!==n&&this.draw();return!0},makeSelectedDateVisible:function(e){outOfViewMonth=t(e).date("1").diff(this.viewStartDate,"months");0>outOfViewMonth?this.viewStartDate.subtract("months",1):0<outOfViewMonth&&outOfViewMonth>=this.settings.months&&this.viewStartDate.add("months",1)},removeSelected:function(e,n){e=t(e).hours(12);for(var r=this._sel.length;r--;)if(this._sel[r].yearDay()===e.yearDay())return this._sel.splice(r,1),this.publish("change",this,[e]),!1!==n&&this.draw(),!0;return!1},draw:function(){var n=t(this.viewStartDate).hours(12),r,s=this.classes,o,u,a,f=0,l,c=0,p,v=this.settings;l=this.calendars.length;do{r=t(n).date(1);r.day(r.day()<this.settings.weekStart?this.settings.weekStart-7:this.settings.weekStart);o=this.calendars[f];o.caption.innerHTML=n.format(this.settings.titleFormat);c=0;do u=o.days[c],a=[],(p=this.isSelected(r))&&a.push({"-1":s.dayInRange,1:s.daySelected,"true":s.daySelected}[p]),r.month()!=n.month()?a.push(s.dayOutOfMonth):a.push(s.dayInMonth),(!this.blackout(r)&&!(this.direction(r)||r.month()!=n.month()&&!1===v.dayOutOfMonthClickable)||0<p)&&a.push(s.dayActive),r.yearDay()===e.yearDay()&&a.push(s.dayToday),p=r.format(this.settings.dayAttributeFormat),v.dateClassMap[p]&&a.push(v.dateClassMap[p]),u.innerHTML=r.format(v.dayNumberFormat),u.className=a.join(" "),u.setAttribute("data-date",p),r.add("days",1);while(42>++c);n.add("months",1)}while(++f<l);if(v.directionScrolling){if("today-past"===v.direction||"past"===v.direction)r=n.add({m:1}).diff(t(),"months",!0),0>=r?(this.disableNextMonth=!1,i.removeClassName(this.container,s.disableNextMonth)):(this.disableNextMonth=!0,i.addClassName(this.container,s.disableNextMonth));else if("today-future"===v.direction||"future"===v.direction)r=n.subtract({m:1}).diff(t(),"months",!0),r>v.months?(this.disablePreviousMonth=!1,i.removeClassName(this.container,s.disablePreviousMonth)):(this.disablePreviousMonth=!0,i.addClassName(this.container,s.disablePreviousMonth));if("today-past"===v.direction||"past"===v.direction)r=n.add({m:12}).diff(t(),"months",!0),-11>=r?(this.disableNextYear=!1,i.removeClassName(this.container,s.disableNextYear)):(this.disableNextYear=!0,i.addClassName(this.container,s.disableNextYear));else if("today-future"===v.direction||"future"===v.direction)r=n.subtract({m:12}).diff(t(),"months",!0),r>11+v.months?(this.disablePreviousYear=!1,i.removeClassName(this.container,s.disablePreviousYear)):(this.disablePreviousYear=!0,i.addClassName(this.container,s.disablePreviousYear))}}};var r=function(e,n,r){var s=[];"string"===typeof e?e=e.split(n):i.isArray(e)||(e=[e]);n=e.length;var o=0;do e[o]&&s.push(t(e[o],r).hours(12));while(++o<n);return s};window.Kalendae=n;var i=n.util={isIE8:function(){return!(!/msie 8./i.test(navigator.appVersion)||/opera/i.test(navigator.userAgent)||!window.ActiveXObject||!XDomainRequest||window.msPerformance)},$:function(e){return"string"==typeof e?document.getElementById(e):e},$$:function(e){return document.querySelectorAll(e)},make:function(e,t,n){var r;e=document.createElement(e);if(t)for(r in t)t.hasOwnProperty(r)&&e.setAttribute(r,t[r]);n&&n.appendChild(e);return e},isVisible:function(e){return 0<e.offsetWidth||0<e.offsetHeight},getStyle:function(e,t){var n;e.currentStyle?n=e.currentStyle[t]:window.getComputedStyle&&(n=window.getComputedStyle(e,null)[t]);return n},domReady:function(e){/in/.test(document.readyState)?setTimeout(function(){i.domReady(e)},9):e()},addEvent:function(e,t,n){var r=function(t){t=t||window.event;var r=n.apply(e,[t,t.target||t.srcElement]);!1===r&&(t.preventDefault?t.preventDefault():(t.returnValue=!1,t.cancelBubble=!0));return r};e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener(t,r,!1);return r},removeEvent:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},hasClassName:function(e,t){if(!(e=i.$(e)))return!1;var n=e.className;return 0<n.length&&(n==t||RegExp("(^|\\s)"+t+"(\\s|$)").test(n))},addClassName:function(e,t){if((e=i.$(e))&&!i.hasClassName(e,t))e.className+=(e.className?" ":"")+t},removeClassName:function(e,t){if(e=i.$(e))e.className=i.trimString(e.className.replace(RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))},isFixed:function(e){do if("fixed"===i.getStyle(e,"position"))return!0;while(e=e.offsetParent);return!1},scrollContainer:function(e){do{var t=i.getStyle(e,"overflow");if("auto"===t||"scroll"===t)return e}while((e=e.parentNode)&&e!=window.document.body);return null},getPosition:function(e,t){var n=e.offsetLeft,r=e.offsetTop,i={};if(!t)for(;e=e.offsetParent;)n+=e.offsetLeft,r+=e.offsetTop;i[0]=i.left=n;i[1]=i.top=r;return i},getHeight:function(e){return e.offsetHeight||e.scrollHeight},getWidth:function(e){return e.offsetWidth||e.scrollWidth},trimString:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},merge:function(){for(var e=!0===arguments[0],t={},n=e?1:0;n<arguments.length;n++){var r=t,i=arguments[n];if("object"===typeof i){var s=void 0;for(s in i)i.hasOwnProperty(s)&&(e&&"object"===typeof r[s]&&"object"===typeof i[s]?_update(r[s],i[s]):r[s]=i[s])}}return t},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)}};"function"===typeof document.addEventListener&&n.util.domReady(function(){for(var e=i.$$(".auto-kal"),t=e.length,r,s;t--;)r=e[t],s=r.getAttribute("data-kal"),s=null==s||""==s?{}:(new Function("return {"+s+"};"))(),"INPUT"===r.tagName?new n.Input(r,s):new n(i.merge(s,{attachTo:r}))});n.Input=function(e,t){if("function"===typeof document.addEventListener||i.isIE8()){var r=this.input=i.$(e),s,o;if(!r||"INPUT"!==r.tagName)throw"First argument for Kalendae.Input must be an <input> element or a valid element id.";var u=this,a=u.classes;o=u.settings=i.merge(u.defaults,t);o.attachTo=window.document.body;o.selected?s=!0:o.selected=r.value;n.call(u,o);o.closeButton&&(o=i.make("a",{"class":a.closeButton},u.container),i.addEvent(o,"click",function(){r.blur()}));s&&(r.value=u.getSelected());s=u.container;var f=!1;s.style.display="none";i.addClassName(s,a.positioned);i.addEvent(s,"mousedown",function(){f=!0});i.addEvent(window.document,"mousedown",function(){f=!1});i.addEvent(r,"focus",function(){u.setSelected(this.value);u.show()});i.addEvent(r,"blur",function(){f?(f=!1,r.focus()):u.hide()});i.addEvent(r,"keyup",function(){u.setSelected(this.value)});(a=i.scrollContainer(r))&&i.addEvent(a,"scroll",function(){r.blur()});u.subscribe("change",function(){r.value=u.getSelected()})}};n.Input.prototype=i.merge(n.prototype,{defaults:i.merge(n.prototype.defaults,{format:"MM/DD/YYYY",side:"bottom",closeButton:!0,offsetLeft:0,offsetTop:0}),classes:i.merge(n.prototype.classes,{positioned:"k-floating",closeButton:"k-btn-close"}),show:function(){var e=this.container,t=e.style,n=this.input,r=i.getPosition(n),s=i.scrollContainer(n),s=s?s.scrollTop:0,o=this.settings;t.display="";switch(o.side){case"left":t.left=r.left-i.getWidth(e)+o.offsetLeft+"px";t.top=r.top+o.offsetTop-s+"px";break;case"right":t.left=r.left+i.getWidth(n)+"px";t.top=r.top+o.offsetTop-s+"px";break;case"top":t.left=r.left+o.offsetLeft+"px";t.top=r.top-i.getHeight(e)+o.offsetTop-s+"px";break;default:t.left=r.left+o.offsetLeft+"px",t.top=r.top+i.getHeight(n)+o.offsetTop-s+"px"}t.position=i.isFixed(n)?"fixed":"absolute";this.publish("show",this)},hide:function(){this.container.style.display="none";this.publish("hide",this)}});var s=function(e){e||(e=this);var t=e.c_||{};e.publish=function(e,n,r){for(var i=(e=t[e])?e.length:0,s;i--;)if(s=e[i].apply(n,r||[]),"boolean"===typeof s)return s};e.subscribe=function(e,n,r){t[e]||(t[e]=[]);r?t[e].push(n):t[e].unshift(n);return[e,n]};e.unsubscribe=function(e){var n=t[e[0]];e=e[1];for(var r=n?n.length:0;r--;)n[r]===e&&n.splice(r,1)}};if(!n.moment)if(window.moment)n.moment=window.moment;else throw"Kalendae requires moment.js. You must use kalendae.standalone.js if moment is not available on the page.";t=n.moment;t.fn.stripTime=function(){this._d=new Date(864e5*Math.floor(this._d.valueOf()/864e5));return this};t.fn.yearDay=function(e){var t=Math.floor(this._d/864e5);return"undefined"===typeof e?t:this.add({d:e-t})};e=n.moment().stripTime();"undefined"!==typeof jQuery&&"function"===typeof document.addEventListener&&(jQuery.fn.kalendae=function(e){this.each(function(t,r){"INPUT"===r.tagName?$(r).data("kalendae",new n.Input(r,e)):$(r).data("kalendae",new n($.extend({},{attachTo:r},e)))});return this})})()