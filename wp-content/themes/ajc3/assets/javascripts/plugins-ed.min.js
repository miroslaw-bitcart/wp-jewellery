!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Spinner=e()}(this,function(){"use strict";function t(t,e){var r,n=document.createElement(t||"div");for(r in e)n[r]=e[r];return n}function e(t){for(var e=1,r=arguments.length;r>e;e++)t.appendChild(arguments[e]);return t}function r(t,e,r,n){var o=["opacity",e,~~(100*t),r,n].join("-"),a=.01+r/n*100,i=Math.max(1-(1-t)/e*(100-a),t),s=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return f[o]||(h.insertRule("@"+l+"keyframes "+o+"{0%{opacity:"+i+"}"+a+"%{opacity:"+t+"}"+(a+.01)+"%{opacity:1}"+(a+e)%100+"%{opacity:"+t+"}100%{opacity:"+i+"}}",h.cssRules.length),f[o]=1),o}function n(t,e){var r,n,o=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<d.length;n++)if(r=d[n]+e,void 0!==o[r])return r;return void 0!==o[e]?e:void 0}function o(t,e){for(var r in e)t.style[n(t,r)||r]=e[r];return t}function a(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)void 0===t[n]&&(t[n]=r[n])}return t}function i(t){for(var e={x:t.offsetLeft,y:t.offsetTop};t=t.offsetParent;)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}function s(t,e){return"string"==typeof t?t:t[e%t.length]}function l(t){return"undefined"==typeof this?new l(t):void(this.opts=a(t||{},l.defaults,p))}function u(){function r(e,r){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',r)}h.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(t,n){function a(){return o(r("group",{coordsize:c+" "+c,coordorigin:-u+" "+-u}),{width:c,height:c})}function i(t,i,l){e(f,e(o(a(),{rotation:360/n.lines*t+"deg",left:~~i}),e(o(r("roundrect",{arcsize:n.corners}),{width:u,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),r("fill",{color:s(n.color,t),opacity:n.opacity}),r("stroke",{opacity:0}))))}var l,u=n.length+n.width,c=2*u,d=2*-(n.width+n.length)+"px",f=o(a(),{position:"absolute",top:d,left:d});if(n.shadow)for(l=1;l<=n.lines;l++)i(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)i(l);return e(t,f)},l.prototype.opacity=function(t,e,r,n){var o=t.firstChild;n=n.shadow&&n.lines||0,o&&e+n<o.childNodes.length&&(o=o.childNodes[e+n],o=o&&o.firstChild,o=o&&o.firstChild,o&&(o.opacity=r))}}var c,d=["webkit","Moz","ms","O"],f={},h=function(){var r=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],r),r.sheet||r.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},a(l.prototype,{spin:function(e){this.stop();var r,n,a=this,s=a.opts,l=a.el=o(t(0,{className:s.className}),{position:s.position,width:0,zIndex:s.zIndex}),u=s.radius+s.length+s.width;if(e&&(e.insertBefore(l,e.firstChild||null),n=i(e),r=i(l),o(l,{left:("auto"==s.left?n.x-r.x+(e.offsetWidth>>1):parseInt(s.left,10)+u)+"px",top:("auto"==s.top?n.y-r.y+(e.offsetHeight>>1):parseInt(s.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),a.lines(l,a.opts),!c){var d,f=0,h=(s.lines-1)*(1-s.direction)/2,p=s.fps,g=p/s.speed,y=(1-s.opacity)/(g*s.trail/100),v=g/s.lines;!function S(){f++;for(var t=0;t<s.lines;t++)d=Math.max(1-(f+(s.lines-t)*v)%g*y,s.opacity),a.opacity(l,t*s.direction+h,d,s);a.timeout=a.el&&setTimeout(S,~~(1e3/p))}()}return a},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(n,a){function i(e,r){return o(t(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:e,boxShadow:r,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*u+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var l,u=0,d=(a.lines-1)*(1-a.direction)/2;u<a.lines;u++)l=o(t(),{position:"absolute",top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:c&&r(a.opacity,a.trail,d+u*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&e(l,o(i("#000","0 0 4px #000"),{top:"2px"})),e(n,e(l,i(s(a.color,u),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(t,e,r){e<t.childNodes.length&&(t.childNodes[e].style.opacity=r)}});var g=o(t("group"),{behavior:"url(#default#VML)"});return!n(g,"transform")&&g.adj?u():c=n(g,"animation"),l}),function(t,e){"use strict";var r=t.console||e,n=t.document,o=t.navigator,a=t.sessionStorage||!1,i=t.setTimeout,s=t.clearTimeout,l=t.setInterval,u=t.clearInterval,c=t.JSON,d=t.alert,f=t.History=t.History||{},h=t.history;if(c.stringify=c.stringify||c.encode,c.parse=c.parse||c.decode,"undefined"!=typeof f.init)throw new Error("History.js Core has already been loaded...");f.init=function(){return"undefined"==typeof f.Adapter?!1:("undefined"!=typeof f.initCore&&f.initCore(),"undefined"!=typeof f.initHtml4&&f.initHtml4(),!0)},f.initCore=function(){if("undefined"!=typeof f.initCore.initialized)return!1;if(f.initCore.initialized=!0,f.options=f.options||{},f.options.hashChangeInterval=f.options.hashChangeInterval||100,f.options.safariPollInterval=f.options.safariPollInterval||500,f.options.doubleCheckInterval=f.options.doubleCheckInterval||500,f.options.storeInterval=f.options.storeInterval||1e3,f.options.busyDelay=f.options.busyDelay||250,f.options.debug=f.options.debug||!1,f.options.initialTitle=f.options.initialTitle||n.title,f.intervalList=[],f.clearAllIntervals=function(){var t,e=f.intervalList;if("undefined"!=typeof e&&null!==e){for(t=0;t<e.length;t++)u(e[t]);f.intervalList=null}},f.debug=function(){f.options.debug&&f.log.apply(f,arguments)},f.log=function(){var t,e,o,a,i,s=!("undefined"==typeof r||"undefined"==typeof r.log||"undefined"==typeof r.log.apply),l=n.getElementById("log");for(s?(a=Array.prototype.slice.call(arguments),t=a.shift(),"undefined"!=typeof r.debug?r.debug.apply(r,[t,a]):r.log.apply(r,[t,a])):t="\n"+arguments[0]+"\n",e=1,o=arguments.length;o>e;++e){if(i=arguments[e],"object"==typeof i&&"undefined"!=typeof c)try{i=c.stringify(i)}catch(u){}t+="\n"+i+"\n"}return l?(l.value+=t+"\n-----\n",l.scrollTop=l.scrollHeight-l.clientHeight):s||d(t),!0},f.getInternetExplorerMajorVersion=function(){var t=f.getInternetExplorerMajorVersion.cached="undefined"!=typeof f.getInternetExplorerMajorVersion.cached?f.getInternetExplorerMajorVersion.cached:function(){for(var t=3,e=n.createElement("div"),r=e.getElementsByTagName("i");(e.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->")&&r[0];);return t>4?t:!1}();return t},f.isInternetExplorer=function(){var t=f.isInternetExplorer.cached="undefined"!=typeof f.isInternetExplorer.cached?f.isInternetExplorer.cached:Boolean(f.getInternetExplorerMajorVersion());return t},f.emulated={pushState:!Boolean(t.history&&t.history.pushState&&t.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(o.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(o.userAgent))),hashChange:Boolean(!("onhashchange"in t||"onhashchange"in n)||f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8)},f.enabled=!f.emulated.pushState,f.bugs={setHash:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),safariPoll:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),ieDoubleCheck:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<7)},f.isEmptyObject=function(t){for(var e in t)return!1;return!0},f.cloneObject=function(t){var e,r;return t?(e=c.stringify(t),r=c.parse(e)):r={},r},f.getRootUrl=function(){var t=n.location.protocol+"//"+(n.location.hostname||n.location.host);return n.location.port&&(t+=":"+n.location.port),t+="/"},f.getBaseHref=function(){var t=n.getElementsByTagName("base"),e=null,r="";return 1===t.length&&(e=t[0],r=e.href.replace(/[^\/]+$/,"")),r=r.replace(/\/+$/,""),r&&(r+="/"),r},f.getBaseUrl=function(){var t=f.getBaseHref()||f.getBasePageUrl()||f.getRootUrl();return t},f.getPageUrl=function(){var t,e=f.getState(!1,!1),r=(e||{}).url||n.location.href;return t=r.replace(/\/+$/,"").replace(/[^\/]+$/,function(t){return/\./.test(t)?t:t+"/"})},f.getBasePageUrl=function(){var t=n.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t){return/[^\/]$/.test(t)?"":t}).replace(/\/+$/,"")+"/";return t},f.getFullUrl=function(t,e){var r=t,n=t.substring(0,1);return e="undefined"==typeof e?!0:e,/[a-z]+\:\/\//.test(t)||(r="/"===n?f.getRootUrl()+t.replace(/^\/+/,""):"#"===n?f.getPageUrl().replace(/#.*/,"")+t:"?"===n?f.getPageUrl().replace(/[\?#].*/,"")+t:e?f.getBaseUrl()+t.replace(/^(\.\/)+/,""):f.getBasePageUrl()+t.replace(/^(\.\/)+/,"")),r.replace(/\#$/,"")},f.getShortUrl=function(t){var e=t,r=f.getBaseUrl(),n=f.getRootUrl();return f.emulated.pushState&&(e=e.replace(r,"")),e=e.replace(n,"/"),f.isTraditionalAnchor(e)&&(e="./"+e),e=e.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},f.store={},f.idToState=f.idToState||{},f.stateToId=f.stateToId||{},f.urlToId=f.urlToId||{},f.storedStates=f.storedStates||[],f.savedStates=f.savedStates||[],f.normalizeStore=function(){f.store.idToState=f.store.idToState||{},f.store.urlToId=f.store.urlToId||{},f.store.stateToId=f.store.stateToId||{}},f.getState=function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!0);var r=f.getLastSavedState();return!r&&e&&(r=f.createStateObject()),t&&(r=f.cloneObject(r),r.url=r.cleanUrl||r.url),r},f.getIdByState=function(t){var e,r=f.extractId(t.url);if(!r)if(e=f.getStateString(t),"undefined"!=typeof f.stateToId[e])r=f.stateToId[e];else if("undefined"!=typeof f.store.stateToId[e])r=f.store.stateToId[e];else{for(;;)if(r=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof f.idToState[r]&&"undefined"==typeof f.store.idToState[r])break;f.stateToId[e]=r,f.idToState[r]=t}return r},f.normalizeState=function(t){var e,r;return t&&"object"==typeof t||(t={}),"undefined"!=typeof t.normalized?t:(t.data&&"object"==typeof t.data||(t.data={}),e={},e.normalized=!0,e.title=t.title||"",e.url=f.getFullUrl(f.unescapeString(t.url||n.location.href)),e.hash=f.getShortUrl(e.url),e.data=f.cloneObject(t.data),e.id=f.getIdByState(e),e.cleanUrl=e.url.replace(/\??\&_suid.*/,""),e.url=e.cleanUrl,r=!f.isEmptyObject(e.data),(e.title||r)&&(e.hash=f.getShortUrl(e.url).replace(/\??\&_suid.*/,""),/\?/.test(e.hash)||(e.hash+="?"),e.hash+="&_suid="+e.id),e.hashedUrl=f.getFullUrl(e.hash),(f.emulated.pushState||f.bugs.safariPoll)&&f.hasUrlDuplicate(e)&&(e.url=e.hashedUrl),e)},f.createStateObject=function(t,e,r){var n={data:t,title:e,url:r};return n=f.normalizeState(n)},f.getStateById=function(t){t=String(t);var r=f.idToState[t]||f.store.idToState[t]||e;return r},f.getStateString=function(t){var e,r,n;return e=f.normalizeState(t),r={data:e.data,title:t.title,url:t.url},n=c.stringify(r)},f.getStateId=function(t){var e,r;return e=f.normalizeState(t),r=e.id},f.getHashByState=function(t){var e,r;return e=f.normalizeState(t),r=e.hash},f.extractId=function(t){var e,r,n;return r=/(.*)\&_suid=([0-9]+)$/.exec(t),n=r?r[1]||t:t,e=r?String(r[2]||""):"",e||!1},f.isTraditionalAnchor=function(t){var e=!/[\/\?\.]/.test(t);return e},f.extractState=function(t,e){var r,n,o=null;return e=e||!1,r=f.extractId(t),r&&(o=f.getStateById(r)),o||(n=f.getFullUrl(t),r=f.getIdByUrl(n)||!1,r&&(o=f.getStateById(r)),o||!e||f.isTraditionalAnchor(t)||(o=f.createStateObject(null,null,n))),o},f.getIdByUrl=function(t){var r=f.urlToId[t]||f.store.urlToId[t]||e;return r},f.getLastSavedState=function(){return f.savedStates[f.savedStates.length-1]||e},f.getLastStoredState=function(){return f.storedStates[f.storedStates.length-1]||e},f.hasUrlDuplicate=function(t){var e,r=!1;return e=f.extractState(t.url),r=e&&e.id!==t.id},f.storeState=function(t){return f.urlToId[t.url]=t.id,f.storedStates.push(f.cloneObject(t)),t},f.isLastSavedState=function(t){var e,r,n,o=!1;return f.savedStates.length&&(e=t.id,r=f.getLastSavedState(),n=r.id,o=e===n),o},f.saveState=function(t){return f.isLastSavedState(t)?!1:(f.savedStates.push(f.cloneObject(t)),!0)},f.getStateByIndex=function(t){var e=null;return e="undefined"==typeof t?f.savedStates[f.savedStates.length-1]:0>t?f.savedStates[f.savedStates.length+t]:f.savedStates[t]},f.getHash=function(){var t=f.unescapeHash(n.location.hash);return t},f.unescapeString=function(e){for(var r,n=e;;){if(r=t.unescape(n),r===n)break;n=r}return n},f.unescapeHash=function(t){var e=f.normalizeHash(t);return e=f.unescapeString(e)},f.normalizeHash=function(t){var e=t.replace(/[^#]*#/,"").replace(/#.*/,"");return e},f.setHash=function(t,e){var r,o,a;return e!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.setHash,args:arguments,queue:e}),!1):(r=f.escapeHash(t),f.busy(!0),o=f.extractState(t,!0),o&&!f.emulated.pushState?f.pushState(o.data,o.title,o.url,!1):n.location.hash!==r&&(f.bugs.setHash?(a=f.getPageUrl(),f.pushState(null,null,a+"#"+r,!1)):n.location.hash=r),f)},f.escapeHash=function(e){var r=f.normalizeHash(e);return r=t.escape(r),f.bugs.hashEscape||(r=r.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),r},f.getHashByUrl=function(t){var e=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return e=f.unescapeHash(e)},f.setTitle=function(t){var e,r=t.title;r||(e=f.getStateByIndex(0),e&&e.url===t.url&&(r=e.title||f.options.initialTitle));try{n.getElementsByTagName("title")[0].innerHTML=r.replace("<","&lt;").replace(">","&gt;").replace(" & "," & ")}catch(o){}return n.title=r,f},f.queues=[],f.busy=function(t){if("undefined"!=typeof t?f.busy.flag=t:"undefined"==typeof f.busy.flag&&(f.busy.flag=!1),!f.busy.flag){s(f.busy.timeout);var e=function(){var t,r,n;if(!f.busy.flag)for(t=f.queues.length-1;t>=0;--t)r=f.queues[t],0!==r.length&&(n=r.shift(),f.fireQueueItem(n),f.busy.timeout=i(e,f.options.busyDelay))};f.busy.timeout=i(e,f.options.busyDelay)}return f.busy.flag},f.busy.flag=!1,f.fireQueueItem=function(t){return t.callback.apply(t.scope||f,t.args||[])},f.pushQueue=function(t){return f.queues[t.queue||0]=f.queues[t.queue||0]||[],f.queues[t.queue||0].push(t),f},f.queue=function(t,e){return"function"==typeof t&&(t={callback:t}),"undefined"!=typeof e&&(t.queue=e),f.busy()?f.pushQueue(t):f.fireQueueItem(t),f},f.clearQueue=function(){return f.busy.flag=!1,f.queues=[],f},f.stateChanged=!1,f.doubleChecker=!1,f.doubleCheckComplete=function(){return f.stateChanged=!0,f.doubleCheckClear(),f},f.doubleCheckClear=function(){return f.doubleChecker&&(s(f.doubleChecker),f.doubleChecker=!1),f},f.doubleCheck=function(t){return f.stateChanged=!1,f.doubleCheckClear(),f.bugs.ieDoubleCheck&&(f.doubleChecker=i(function(){return f.doubleCheckClear(),f.stateChanged||t(),!0},f.options.doubleCheckInterval)),f},f.safariStatePoll=function(){var e,r=f.extractState(n.location.href);if(!f.isLastSavedState(r))return e=r,e||(e=f.createStateObject()),f.Adapter.trigger(t,"popstate"),f},f.back=function(t){return t!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.back,args:arguments,queue:t}),!1):(f.busy(!0),f.doubleCheck(function(){f.back(!1)}),h.go(-1),!0)},f.forward=function(t){return t!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.forward,args:arguments,queue:t}),!1):(f.busy(!0),f.doubleCheck(function(){f.forward(!1)}),h.go(1),!0)},f.go=function(t,e){var r;if(t>0)for(r=1;t>=r;++r)f.forward(e);else{if(!(0>t))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(r=-1;r>=t;--r)f.back(e)}return f},f.emulated.pushState){var p=function(){};f.pushState=f.pushState||p,f.replaceState=f.replaceState||p}else f.onPopState=function(e,r){var o,a,i=!1,s=!1;return f.doubleCheckComplete(),(o=f.getHash())?(a=f.extractState(o||n.location.href,!0),a?f.replaceState(a.data,a.title,a.url,!1):(f.Adapter.trigger(t,"anchorchange"),f.busy(!1)),f.expectedStateId=!1,!1):(i=f.Adapter.extractEventData("state",e,r)||!1,s=i?f.getStateById(i):f.expectedStateId?f.getStateById(f.expectedStateId):f.extractState(n.location.href),s||(s=f.createStateObject(null,null,n.location.href)),f.expectedStateId=!1,f.isLastSavedState(s)?(f.busy(!1),!1):(f.storeState(s),f.saveState(s),f.setTitle(s),f.Adapter.trigger(t,"statechange"),f.busy(!1),!0))},f.Adapter.bind(t,"popstate",f.onPopState),f.pushState=function(e,r,n,o){if(f.getHashByUrl(n)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(o!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.pushState,args:arguments,queue:o}),!1;f.busy(!0);var a=f.createStateObject(e,r,n);return f.isLastSavedState(a)?f.busy(!1):(f.storeState(a),f.expectedStateId=a.id,h.pushState(a.id,a.title,a.url),f.Adapter.trigger(t,"popstate")),!0},f.replaceState=function(e,r,n,o){if(f.getHashByUrl(n)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(o!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.replaceState,args:arguments,queue:o}),!1;f.busy(!0);var a=f.createStateObject(e,r,n);return f.isLastSavedState(a)?f.busy(!1):(f.storeState(a),f.expectedStateId=a.id,h.replaceState(a.id,a.title,a.url),f.Adapter.trigger(t,"popstate")),!0};if(a){try{f.store=c.parse(a.getItem("History.store"))||{}}catch(g){f.store={}}f.normalizeStore()}else f.store={},f.normalizeStore();f.Adapter.bind(t,"beforeunload",f.clearAllIntervals),f.Adapter.bind(t,"unload",f.clearAllIntervals),f.saveState(f.storeState(f.extractState(n.location.href,!0))),a&&(f.onUnload=function(){var t,e;try{t=c.parse(a.getItem("History.store"))||{}}catch(r){t={}}t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{};for(e in f.idToState)f.idToState.hasOwnProperty(e)&&(t.idToState[e]=f.idToState[e]);for(e in f.urlToId)f.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=f.urlToId[e]);for(e in f.stateToId)f.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=f.stateToId[e]);f.store=t,f.normalizeStore(),a.setItem("History.store",c.stringify(t))},f.intervalList.push(l(f.onUnload,f.options.storeInterval)),f.Adapter.bind(t,"beforeunload",f.onUnload),f.Adapter.bind(t,"unload",f.onUnload)),f.emulated.pushState||(f.bugs.safariPoll&&f.intervalList.push(l(f.safariStatePoll,f.options.safariPollInterval)),("Apple Computer, Inc."===o.vendor||"Mozilla"===(o.appCodeName||""))&&(f.Adapter.bind(t,"hashchange",function(){f.Adapter.trigger(t,"popstate")}),f.getHash()&&f.Adapter.onDomLoad(function(){f.Adapter.trigger(t,"hashchange")})))},f.init()}(window),function(){var t=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1},e=[].slice;!function(t,e){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(r){return e(r,t)}):e(t.jQuery,t)}(this,function(r,n){var o,a,i,s,l,u,c,d,f,h,p,g,y,v,S,b;return o=r(n),d=t.call(n,"ontouchstart")>=0,s={horizontal:{},vertical:{}},l=1,c={},u="waypoints-context-id",p="resize.waypoints",g="scroll.waypoints",y=1,v="waypoints-waypoint-ids",S="waypoint",b="waypoints",a=function(){function t(t){var e=this;this.$element=t,this.element=t[0],this.didResize=!1,this.didScroll=!1,this.id="context"+l++,this.oldScroll={x:t.scrollLeft(),y:t.scrollTop()},this.waypoints={horizontal:{},vertical:{}},t.data(u,this.id),c[this.id]=this,t.bind(g,function(){var t;return e.didScroll||d?void 0:(e.didScroll=!0,t=function(){return e.doScroll(),e.didScroll=!1},n.setTimeout(t,r[b].settings.scrollThrottle))}),t.bind(p,function(){var t;return e.didResize?void 0:(e.didResize=!0,t=function(){return r[b]("refresh"),e.didResize=!1},n.setTimeout(t,r[b].settings.resizeThrottle))})}return t.prototype.doScroll=function(){var t,e=this;return t={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!d||t.vertical.oldScroll&&t.vertical.newScroll||r[b]("refresh"),r.each(t,function(t,n){var o,a,i;return i=[],a=n.newScroll>n.oldScroll,o=a?n.forward:n.backward,r.each(e.waypoints[t],function(t,e){var r,o;return n.oldScroll<(r=e.offset)&&r<=n.newScroll?i.push(e):n.newScroll<(o=e.offset)&&o<=n.oldScroll?i.push(e):void 0}),i.sort(function(t,e){return t.offset-e.offset}),a||i.reverse(),r.each(i,function(t,e){return e.options.continuous||t===i.length-1?e.trigger([o]):void 0})}),this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}},t.prototype.refresh=function(){var t,e,n,o=this;return n=r.isWindow(this.element),e=this.$element.offset(),this.doScroll(),t={horizontal:{contextOffset:n?0:e.left,contextScroll:n?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:n?0:e.top,contextScroll:n?0:this.oldScroll.y,contextDimension:n?r[b]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},r.each(t,function(t,e){return r.each(o.waypoints[t],function(t,n){var o,a,i,s,l;return o=n.options.offset,i=n.offset,a=r.isWindow(n.element)?0:n.$element.offset()[e.offsetProp],r.isFunction(o)?o=o.apply(n.element):"string"==typeof o&&(o=parseFloat(o),n.options.offset.indexOf("%")>-1&&(o=Math.ceil(e.contextDimension*o/100))),n.offset=a-e.contextOffset+e.contextScroll-o,n.options.onlyOnScroll&&null!=i||!n.enabled?void 0:null!==i&&i<(s=e.oldScroll)&&s<=n.offset?n.trigger([e.backward]):null!==i&&i>(l=e.oldScroll)&&l>=n.offset?n.trigger([e.forward]):null===i&&e.oldScroll>=n.offset?n.trigger([e.forward]):void 0})})},t.prototype.checkEmpty=function(){return r.isEmptyObject(this.waypoints.horizontal)&&r.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([p,g].join(" ")),delete c[this.id]):void 0},t}(),i=function(){function t(t,e,n){var o,a;n=r.extend({},r.fn[S].defaults,n),"bottom-in-view"===n.offset&&(n.offset=function(){var t;return t=r[b]("viewportHeight"),r.isWindow(e.element)||(t=e.$element.height()),t-r(this).outerHeight()}),this.$element=t,this.element=t[0],this.axis=n.horizontal?"horizontal":"vertical",this.callback=n.handler,this.context=e,this.enabled=n.enabled,this.id="waypoints"+y++,this.offset=null,this.options=n,e.waypoints[this.axis][this.id]=this,s[this.axis][this.id]=this,o=null!=(a=t.data(v))?a:[],o.push(this.id),t.data(v,o)}return t.prototype.trigger=function(t){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,t),this.options.triggerOnce?this.destroy():void 0):void 0},t.prototype.disable=function(){return this.enabled=!1},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},t.prototype.destroy=function(){return delete s[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},t.getWaypointsByElement=function(t){var e,n;return(n=r(t).data(v))?(e=r.extend({},s.horizontal,s.vertical),r.map(n,function(t){return e[t]})):[]},t}(),h={init:function(t,e){var n;return null==e&&(e={}),null==(n=e.handler)&&(e.handler=t),this.each(function(){var t,n,o,s;return t=r(this),o=null!=(s=e.context)?s:r.fn[S].defaults.context,r.isWindow(o)||(o=t.closest(o)),o=r(o),n=c[o.data(u)],n||(n=new a(o)),new i(t,n,e)}),r[b]("refresh"),this},disable:function(){return h._invoke(this,"disable")},enable:function(){return h._invoke(this,"enable")},destroy:function(){return h._invoke(this,"destroy")},prev:function(t,e){return h._traverse.call(this,t,e,function(t,e,r){return e>0?t.push(r[e-1]):void 0})},next:function(t,e){return h._traverse.call(this,t,e,function(t,e,r){return e<r.length-1?t.push(r[e+1]):void 0})},_traverse:function(t,e,o){var a,i;return null==t&&(t="vertical"),null==e&&(e=n),i=f.aggregate(e),a=[],this.each(function(){var e;return e=r.inArray(this,i[t]),o(a,e,i[t])}),this.pushStack(a)},_invoke:function(t,e){return t.each(function(){var t;return t=i.getWaypointsByElement(this),r.each(t,function(t,r){return r[e](),!0})}),this}},r.fn[S]=function(){var t,n;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],h[n]?h[n].apply(this,t):r.isFunction(n)?h.init.apply(this,arguments):r.isPlainObject(n)?h.init.apply(this,[null,n]):r.error(n?"The "+n+" method does not exist in jQuery Waypoints.":"jQuery Waypoints needs a callback function or handler option.")},r.fn[S].defaults={context:n,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},f={refresh:function(){return r.each(c,function(t,e){return e.refresh()})},viewportHeight:function(){var t;return null!=(t=n.innerHeight)?t:o.height()},aggregate:function(t){var e,n,o;return e=s,t&&(e=null!=(o=c[r(t).data(u)])?o.waypoints:void 0),e?(n={horizontal:[],vertical:[]},r.each(n,function(t,o){return r.each(e[t],function(t,e){return o.push(e)}),o.sort(function(t,e){return t.offset-e.offset}),n[t]=r.map(o,function(t){return t.element}),n[t]=r.unique(n[t])}),n):[]},above:function(t){return null==t&&(t=n),f._filter(t,"vertical",function(t,e){return e.offset<=t.oldScroll.y})},below:function(t){return null==t&&(t=n),f._filter(t,"vertical",function(t,e){return e.offset>t.oldScroll.y})},left:function(t){return null==t&&(t=n),f._filter(t,"horizontal",function(t,e){return e.offset<=t.oldScroll.x})},right:function(t){return null==t&&(t=n),f._filter(t,"horizontal",function(t,e){return e.offset>t.oldScroll.x})},enable:function(){return f._invoke("enable")},disable:function(){return f._invoke("disable")},destroy:function(){return f._invoke("destroy")},extendFn:function(t,e){return h[t]=e},_invoke:function(t){var e;return e=r.extend({},s.vertical,s.horizontal),r.each(e,function(e,r){return r[t](),!0})},_filter:function(t,e,n){var o,a;return(o=c[r(t).data(u)])?(a=[],r.each(o.waypoints[e],function(t,e){return n(o,e)?a.push(e):void 0}),a.sort(function(t,e){return t.offset-e.offset}),r.map(a,function(t){return t.element})):[]}},r[b]=function(){var t,r;return r=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],f[r]?f[r].apply(null,t):f.aggregate.call(null,r)},r[b].settings={resizeThrottle:100,scrollThrottle:30},o.load(function(){return r[b]("refresh")})})}.call(this);